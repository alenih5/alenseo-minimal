<!DOCTYPE html>
<html>
<head>
    <title>Alenseo AJAX Test</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
        .info { color: blue; }
        button { padding: 8px 16px; margin: 5px; }
        #results { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Alenseo Plugin AJAX Test</h1>
    
    <div class="test-section">
        <h3>API Test Functions</h3>
        <p>Test the API connection functions directly</p>
        
        <div>
            <label>Claude API Key:</label>
            <input type="text" id="claude-api-key" placeholder="Enter Claude API key" style="width: 300px;">
            <button onclick="testClaudeAPI()">Test Claude API</button>
        </div>
        
        <div style="margin-top: 10px;">
            <label>OpenAI API Key:</label>
            <input type="text" id="openai-api-key" placeholder="Enter OpenAI API key" style="width: 300px;">
            <button onclick="testOpenAIAPI()">Test OpenAI API</button>
        </div>
    </div>
    
    <div class="test-section">
        <h3>Dashboard Functions</h3>
        <button onclick="loadDashboardData()">Load Dashboard Data</button>
        <button onclick="getAPIStatus()">Get API Status</button>
        <button onclick="loadPosts()">Load Posts</button>
    </div>
    
    <div id="results"></div>

    <script>
        // WordPress AJAX URL - you'll need to update this with your actual WordPress URL
        const ajaxUrl = '/wp-admin/admin-ajax.php'; // Update this path
        const nonce = 'test-nonce'; // This should be generated by WordPress
        
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
            results.scrollTop = results.scrollHeight;
        }
        
        function testClaudeAPI() {
            const apiKey = document.getElementById('claude-api-key').value;
            if (!apiKey) {
                log('Please enter a Claude API key', 'error');
                return;
            }
            
            log('Testing Claude API...', 'info');
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: {
                    action: 'alenseo_test_claude_api',
                    api_key: apiKey,
                    model: 'claude-3-5-sonnet-20241022',
                    nonce: nonce
                },
                timeout: 30000,
                success: function(response) {
                    if (response.success) {
                        log('✅ Claude API test successful!', 'success');
                        if (response.data.details) {
                            log(`Details: ${JSON.stringify(response.data.details)}`, 'info');
                        }
                    } else {
                        log(`❌ Claude API test failed: ${response.data.message}`, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log(`❌ Claude API AJAX error: ${error}`, 'error');
                }
            });
        }
        
        function testOpenAIAPI() {
            const apiKey = document.getElementById('openai-api-key').value;
            if (!apiKey) {
                log('Please enter an OpenAI API key', 'error');
                return;
            }
            
            log('Testing OpenAI API...', 'info');
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: {
                    action: 'alenseo_test_openai_api',
                    api_key: apiKey,
                    model: 'gpt-3.5-turbo',
                    nonce: nonce
                },
                timeout: 30000,
                success: function(response) {
                    if (response.success) {
                        log('✅ OpenAI API test successful!', 'success');
                        if (response.data.details) {
                            log(`Details: ${JSON.stringify(response.data.details)}`, 'info');
                        }
                    } else {
                        log(`❌ OpenAI API test failed: ${response.data.message}`, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log(`❌ OpenAI API AJAX error: ${error}`, 'error');
                }
            });
        }
        
        function loadDashboardData() {
            log('Loading dashboard data...', 'info');
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: {
                    action: 'alenseo_get_dashboard_data',
                    nonce: nonce
                },
                success: function(response) {
                    if (response.success) {
                        log('✅ Dashboard data loaded successfully!', 'success');
                        log(`Stats: ${JSON.stringify(response.data.stats)}`, 'info');
                    } else {
                        log(`❌ Dashboard data loading failed: ${response.data.message}`, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log(`❌ Dashboard data AJAX error: ${error}`, 'error');
                }
            });
        }
        
        function getAPIStatus() {
            log('Getting API status...', 'info');
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: {
                    action: 'alenseo_get_api_status',
                    nonce: nonce
                },
                success: function(response) {
                    if (response.success) {
                        log('✅ API status retrieved!', 'success');
                        log(`Status: ${JSON.stringify(response.data)}`, 'info');
                    } else {
                        log(`❌ API status failed: ${response.data.message}`, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log(`❌ API status AJAX error: ${error}`, 'error');
                }
            });
        }
        
        function loadPosts() {
            log('Loading posts...', 'info');
            
            $.ajax({
                url: ajaxUrl,
                type: 'POST',
                data: {
                    action: 'alenseo_load_posts',
                    page: 1,
                    per_page: 5,
                    post_type: 'any',
                    nonce: nonce
                },
                success: function(response) {
                    if (response.success) {
                        log('✅ Posts loaded successfully!', 'success');
                        log(`Found ${response.data.total_posts} posts`, 'info');
                        if (response.data.posts.length > 0) {
                            log(`First post: ${response.data.posts[0].title}`, 'info');
                        }
                    } else {
                        log(`❌ Posts loading failed: ${response.data.message}`, 'error');
                    }
                },
                error: function(xhr, status, error) {
                    log(`❌ Posts loading AJAX error: ${error}`, 'error');
                }
            });
        }
        
        log('AJAX test page loaded. Ready to test Alenseo plugin functions!', 'success');
    </script>
</body>
</html>
